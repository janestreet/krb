The original version of this code was written by John Kilburg
<john@greenjeans.com>.
